<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Staff Expense - Sainath</title>
    <link rel="stylesheet" href="css/inventory.css">
    <!-- For PDF Export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"
        integrity="sha512-GsLlZN/3F2ErC5ifS5QtgpiJtWd43JWSuIgh7mbzZ8zBps+dvLusV+eNQATqgA/HdeKFVgA5v3S/cIrLF7QnIg=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <!-- For Excel Export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>

<body>
    <div class="staff-expense-container">
        <!-- Header with Add Button, Print and Export -->
        <div class="staff-expense-header"
            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
            <h1 style="font-size: 22px; font-weight: 600; margin: 0; color: #1f2937;">Staff Expense</h1>
            <div class="header-actions" style="display: flex; gap: 10px; align-items: center;">
                <button onclick="printReport()" class="btn-print" title="Print Report">
                    <span style="font-size: 18px;">üñ®Ô∏è</span> Print
                </button>
                <div class="export-dropdown-wrapper">
                    <button onclick="toggleExportDropdown()" class="btn-export" title="Export Report">
                        <span style="font-size: 18px;">üì•</span> Export
                    </button>
                    <div id="exportDropdown" class="export-dropdown-menu">
                        <button onclick="exportToPDF()" class="export-option">
                            <span>üìÑ</span> PDF
                        </button>
                        <button onclick="exportToExcel()" class="export-option">
                            <span>üìä</span> Excel
                        </button>
                    </div>
                </div>
                <button onclick="openExpenseForm()" class="btn-add-expense">
                    + Add Expense
                </button>
            </div>
        </div>

        <!-- Selection Cards Row (4 columns) -->
        <div class="selection-row">
            <!-- Staff Selection -->
            <div class="selection-card">
                <label>Staff Selection</label>
                <select id="invStaffSelect" onchange="handleStaffChange(this.value)" class="selection-input">
                    <option value="">Select Staff</option>
                </select>
            </div>

            <!-- Month Selection -->
            <div class="selection-card">
                <label>Month Selection</label>
                <select id="invMonthSelect" onchange="handleMonthChange(this.value)" class="selection-input">
                    <option value="">Select Month</option>
                </select>
            </div>

            <!-- Balance Card -->
            <div class="selection-card">
                <label>Balance</label>
                <div id="staffBalanceCard" class="stat-display">
                    <div style="text-align: center; color: #999;">Select staff</div>
                </div>
            </div>

            <!-- Salary Card -->
            <div class="selection-card">
                <label>Salary</label>
                <div class="stat-display" id="invStaffSalary"
                    style="font-size: 20px; font-weight: bold; color: #667eea; text-align: center;">
                    ‚Çπ0.00
                </div>
            </div>
        </div>

        <!-- UPDATED Summary Cards Row - 3 Cards in First Row -->
        <div class="summary-cards-row summary-cards-row-new" style="grid-template-columns: repeat(3, 1fr);">
            <!-- Cap Card - Shows only days wear -->
            <div class="summary-card">
                <div class="summary-card-content" style="text-align: center; padding: 10px; display: flex;">
                    <div style="font-size: 14px; color: #1f2937; font-weight: 600; line-height: 1.4;">
                        üß¢ Cap
                    </div>
                    <div
                        style="font-size: 18px; font-weight: 700; margin-top: 6px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                        <span id="capDaysWear">0</span> days
                    </div>
                </div>
            </div>

            <!-- T-Shirt Card - Shows only days wear -->
            <div class="summary-card">
                <div class="summary-card-content" style="text-align: center; padding: 10px;">
                    <div style="font-size: 14px; color: #1f2937; font-weight: 600; line-height: 1.4;">
                        üëï T-Shirt
                    </div>
                    <div
                        style="font-size: 18px; font-weight: 700; margin-top: 6px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                        <span id="tshirtDaysWear">0</span> days
                    </div>
                </div>
            </div>

            <!-- Attendance Card - Shows only present days -->
            <div class="summary-card">
                <div class="summary-card-content" style="text-align: center; padding: 10px;">
                    <div style="font-size: 14px; color: #1f2937; font-weight: 600; line-height: 1.4;">
                        ‚úÖ Attendance
                    </div>
                    <div
                        style="font-size: 18px; font-weight: 700; margin-top: 6px; background: linear-gradient(135deg, #10b981 0%, #059669 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                        Present day <span id="presentDayCount">0</span> days <br>
                        Half day <span id="halfDayCount">0</span> days

                    </div>
                </div>
            </div>
        </div>

        <style>
            /* Responsive styles for new summary cards */
            @media (max-width: 768px) {
                .summary-cards-row-new {
                    grid-template-columns: repeat(2, 1fr) !important;
                }

                .summary-cards-row-new .summary-card:last-child {
                    grid-column: 1 / -1;
                }
            }

            @media (max-width: 480px) {
                .summary-cards-row-new {
                    grid-template-columns: 1fr !important;
                }

                .summary-cards-row-new .summary-card:last-child {
                    grid-column: auto;
                }

                .summary-cards-row-new .summary-card-content>div:first-child {
                    font-size: 13px !important;
                }

                .summary-cards-row-new .summary-card-content>div:last-child {
                    font-size: 16px !important;
                }
            }
        </style>

        <!-- Main Content - Display Expenses Table -->
        <div class="expense-content" style="grid-template-columns: 1fr;">
            <!-- Display Expenses Table -->
            <div class="expense-section">
                <h2 style="margin-bottom: 15px; color: #1f2937; font-size: 15px; font-weight: 600;">Display Expense Per
                    User</h2>
                <div id="staffExpensesList" style="max-height: 500px; overflow-y: auto;">
                    <div style="padding: 20px; text-align: center; color: #999;">
                        <p style="font-size: 16px; margin-bottom: 10px;">No expenses recorded</p>
                        <p style="font-size: 14px;">Select a staff member to view expenses</p>
                    </div>
                </div>
                <div style="padding-top: 15px; border-top: 1px solid #e5e7eb; margin-top: 15px;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <span style="font-size: 14px; font-weight: 500; color: #374151;">Total Expenses:</span>
                        <span id="invTotalExpense"
                            style="font-size: 20px; font-weight: bold; color: #ef4444;">‚Çπ0.00</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for Add Expense Form -->
    <div id="expenseFormModal" class="expense-modal">
        <div class="expense-modal-overlay" onclick="closeExpenseForm()"></div>
        <div class="expense-modal-box">
            <div class="expense-modal-header">
                <h2>Add new expense</h2>
                <button type="button" class="expense-modal-close" onclick="closeExpenseForm()">‚úï</button>
            </div>
            <div class="expense-modal-form-wrapper">
                <form id="expenseForm" onsubmit="handleAddExpense(event)" class="expense-modal-form">
                    <div class="expense-form-grid">
                        <!-- Row 1: Date and Amount -->
                        <div class="expense-form-row">
                            <div class="expense-form-group">
                                <label for="invExpenseDate">Date</label>
                                <input type="date" id="invExpenseDate" required class="expense-form-input">
                            </div>

                            <div class="expense-form-group">
                                <label for="invExpenseAmount">Amount</label>
                                <input type="number" id="invExpenseAmount" placeholder="Enter amount" required min="0"
                                    step="0.01" class="expense-form-input">
                            </div>
                        </div>

                        <!-- Row 2: Payment Mode and Bank Account -->
                        <div class="expense-form-row">
                            <div class="expense-form-group">
                                <label for="expensePaymentMode">Payment Mode</label>
                                <select id="expensePaymentMode" required class="expense-form-input"
                                    onchange="handleInventoryPaymentMode(this.value)">
                                    <option value="cash" selected>Cash</option>
                                    <option value="upi">UPI</option>
                                    <option value="bank">Bank</option>
                                </select>
                            </div>

                            <div class="expense-form-group">
                                <label for="expenseBankAccount">Bank Account</label>
                                <select id="expenseBankAccount" class="expense-form-input" disabled>
                                    <option value="">N/A</option>
                                </select>
                            </div>
                        </div>

                        <!-- Row 3: Notes (Full Width) -->
                        <div class="expense-form-group expense-form-group-full">
                            <label for="invExpenseNote">Notes</label>
                            <textarea id="invExpenseNote" placeholder="Enter notes..." rows="5"
                                class="expense-form-input expense-form-textarea"></textarea>
                        </div>
                    </div>

                    <div class="expense-modal-footer expense-modal-footer-left">
                        <button type="button" onclick="closeExpenseForm()" class="expense-btn-cancel">Cancel</button>
                        <button type="submit" class="expense-btn-save">Save</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script type="module" src="./js/inventory.js"></script>
</body>

</html>